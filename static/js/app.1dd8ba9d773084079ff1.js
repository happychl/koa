webpackJsonp([1],[,,,,,,,,,,,,,function(t,e,a){"use strict";var s=a(7),n=a(60),r=a(56),i=a.n(r),o=a(55),c=a.n(o);s.a.use(n.a),e.a=new n.a({routes:[{path:"/",name:"Home",component:i.a},{path:"/chat",name:"Chat",component:c.a}]})},,function(t,e,a){function s(t){a(54)}var n=a(6)(a(16),a(59),s,"data-v-f5dda2a6",null);t.exports=n.exports},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(50),n=(a.n(s),a(51));a.n(n),a(0);e.default={name:"app",mounted:function(){},methods:{}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(8),n=a.n(s),r=a(0);e.default={name:"chat",data:function(){return{messages:[],sendTxt:""}},mounted:function(){var t=this;if(this.$store.state.remember){var e=io.connect("http://localhost:3000");e.on("connect",function(){console.log("connect server"),e.emit("userInfo",{name:t.$store.state.username})}),e.on("userId",function(e){t.$data.id=e.userId}),e.on("message",function(e){e.self=e.id&&e.id===t.$data.id,t.$data.messages.push(e)})}else this.$router.push({path:"/"})},computed:n()({},a.i(r.b)(["avatar","username"])),watch:{messages:function(){this.$nextTick(function(){document.getElementById("message").scrollTop=document.getElementById("message").scrollHeight})}},methods:{focus:function(){var t=document.getElementById("message").scrollTop,e=void 0,a=3e3;e=setInterval(function(){document.getElementById("message").scrollTop=document.getElementById("message").scrollHeight,(document.getElementById("message").scrollTop>t||!a--)&&clearInterval(e)},100)},send:function(){if(this.$data.sendTxt.length){var t={name:this.$store.state.username,text:this.$data.sendTxt,avatar:this.$store.state.avatar,loc:"上海市"};this.$data.sendTxt="",socket.emit("message",t)}}}}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(20),n=a.n(s),r=a(8),i=a.n(r),o=a(0);e.default={name:"home",data:function(){return{tips:""}},computed:i()({},a.i(o.b)(["remember","avatar"]),{username:{get:function(){return this.$store.state.username},set:function(t){this.updateUsername(t)}}}),mounted:function(){var t=this,e=window.localStorage.getItem("profile");e?(this.initialState(JSON.parse(e)),setTimeout(function(){t.$router.push({path:"/chat"})},3e3)):this.changeAvatar()},methods:i()({},a.i(o.c)(["initialState","setRemember","changeAvatar","updateUsername"]),{login:function(){this.$store.state.username?(window.localStorage.setItem("profile",n()({name:this.$store.state.username,avatar:this.$store.state.avatar})),this.setRemember(),this.$router.push({path:"/chat"})):this.$data.tips="取个名字吧，亲"}})}},function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(7),n=a(0),r=a(15),i=a.n(r),o=a(13),c=a(14),u=a.n(c);s.a.config.productionTip=!1,s.a.prototype.$jq=u.a,s.a.use(n.a);var l=new n.a.Store({state:{remember:!1,avatar:"",username:""},mutations:{initialState:function(t,e){t.remember=!0,t.avatar=e.avatar,t.username=e.name},setRemember:function(t){t.remember=!0},changeAvatar:function(t){t.avatar="../../static/image/avatar/avatar"+Math.ceil(45*Math.random())+".jpg"},updateUsername:function(t,e){t.username=e}}});new s.a({el:"#app",router:o.a,store:l,template:"<App/>",components:{App:i.a}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e,a){function s(t){a(53)}var n=a(6)(a(17),a(58),s,"data-v-61de597d",null);t.exports=n.exports},function(t,e,a){function s(t){a(52)}var n=a(6)(a(18),a(57),s,"data-v-2192c0f8",null);t.exports=n.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"home"},[t.remember?a("section",{staticClass:"welcome"},[a("img",{staticClass:"avatar",attrs:{src:t.avatar,alt:""}}),t._v(" "),a("p",{staticClass:"name"},[t._v(t._s(t.username))]),t._v(" "),a("p",{staticClass:"wel"},[t._v("-------欢迎回来-------")])]):a("section",{staticClass:"form"},[a("img",{staticClass:"avatar",attrs:{src:t.avatar,alt:""},on:{click:t.changeAvatar}}),t._v(" "),a("div",{staticClass:"usr"},[a("label",{staticClass:"usr-label",attrs:{for:"username"}},[t._v("昵称")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model:value",value:t.username,expression:"username",arg:"value"}],staticClass:"usr-ipt",attrs:{type:"text",id:"username",placeholder:"请输入昵称",autofocus:""},domProps:{value:t.username},on:{keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.login(e)},input:function(e){e.target.composing||(t.username=e.target.value)}}}),t._v(" "),a("p",{staticClass:"tips"},[t._v(t._s(t.tips))])]),t._v(" "),a("button",{staticClass:"login",on:{click:t.login}},[t._v("登陆")])])])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chat"},[t._m(0),t._v(" "),a("section",{staticClass:"content",attrs:{id:"message"}},[a("ul",{staticClass:"message__list"},[t._l(t.messages,function(e){return[0===e.type?a("li",{staticClass:"message__item"},[a("p",{staticClass:"message__tip"},[t._v("欢迎 "+t._s(e.name)+" 进入聊天室")])]):a("li",{staticClass:"message__item",class:{self:e.self}},[a("p",{staticClass:"message__info"},[e.self?[a("span",{staticClass:"message__addr"},[t._v(t._s(e.loc))]),t._v(" "),a("span",{staticClass:"message__from"},[t._v(t._s(e.name))])]:[a("span",{staticClass:"message__from"},[t._v(t._s(e.name))]),t._v(" "),a("span",{staticClass:"message__addr"},[t._v(t._s(e.loc))])]],2),t._v(" "),a("div",{staticClass:"message__main"},[e.self?[a("p",{staticClass:"message__con"},[t._v(t._s(e.text))]),t._v(" "),a("p",{staticClass:"message__avatar"},[a("img",{staticClass:"message__avatar",attrs:{src:e.avatar,alt:""}})])]:[a("p",{staticClass:"message__avatar"},[a("img",{staticClass:"message__avatar",attrs:{src:e.avatar,alt:""}})]),t._v(" "),a("p",{staticClass:"message__con"},[t._v(t._s(e.text))])]],2)])]})],2)]),t._v(" "),a("section",{staticClass:"send"},[a("input",{directives:[{name:"model",rawName:"v-model:value",value:t.sendTxt,expression:"sendTxt",arg:"value"}],staticClass:"send-ipt",attrs:{type:"text"},domProps:{value:t.sendTxt},on:{keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.send(e)},focus:t.focus,input:function(e){e.target.composing||(t.sendTxt=e.target.value)}}}),t._v(" "),a("button",{staticClass:"send-btn",class:{active:t.sendTxt.length},on:{click:t.send}},[t._v("发送")])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("header",{staticClass:"header"},[a("h1",[t._v("聊天室")])])}]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},staticRenderFns:[]}}],[19]);
//# sourceMappingURL=app.1dd8ba9d773084079ff1.js.map